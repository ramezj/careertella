import { auth } from "@/auth"
import { getUserJobs } from "@/server-actions/jobs/get-user-jobs";
import { redirect } from "next/navigation";
import { JobsTable } from "@/components/jobs-table";
import { Job } from "@prisma/client";
import { toast } from "sonner";
import { Metadata } from "next";
import { CreateJobButton } from "@/components/create-job";

export const metadata: Metadata = {
  title: "Jobs",
  description: "Generated by create next app",
};


export default async function Page() {
  const session = await auth();
  if(!session) { redirect('/auth') }
  const jobs = await getUserJobs();
  if(jobs?.ok === false) { toast(jobs.message) }
  return (
    <>
    <h1 className="font-bold text-3xl">Jobs</h1>
    {
      jobs.jobs?.length as number === 0 
      ? 
      <div className="w-full border border-white/20 h-full rounded-md items-center flex flex-col gap-2 justify-center">
        <h1 className="font-bold text-lg">You dont have any jobs yet</h1>
        <p className="text-muted-foreground">Create some jobs & start hiring immediately.</p>
        <CreateJobButton />
      </div>
      : 
      <> 
      <JobsTable jobs={jobs?.jobs as Job[]} />
      </>
    }
    </>
  )
}